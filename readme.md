### Project2 说明文档  
***  
19302010046   陈思帆   
* 项目总体完成情况：  
   * 部分页面使用bootstrap框架（主要为搜索结果展示，我的照片与收藏展示与分页逻辑的实现），其余页面的样式与pj1相同。
     所有页面均应用pj1的css样式，部分css样式在布局，背景颜色等方面有所改动。
   * pj2需求文档中的网站具体需求已基本满足，经测试可在Edge，Google Chrome浏览器正常显示。
   * 项目采用utf-8编码，支持多语言运行。   
   * 图片仍使用自由版式裁剪的图片，与pj1相同。
   * 项目基本实现前后端分离（除导航栏的显示，提交表单等使用内嵌php方式外）。网站功能的实现的核心思路为利用ajax实现php与js
   的数据交互问题。
   * 具体思路为：js通过id获取前端页面的元素节点，当js捕获事件后（点击等），利用ajax的post方式将前端页面事件相关的数据传递给
   php脚本，php脚本通过mysqli方式与数据库建立连接，并通过具体的sql语句对数据库的相关内容进行修改（如插入，删除等），并以json数组
   的形式返回给js，js接受到php返回的json数组后，执行callback函数，利用dom修改前端页面内容，从而实现相应功能。
* 项目具体情况：
   * 登录逻辑及导航栏随用户登录状态切换的实现 
     登录逻辑的实现：利用action="login.php"，当提交表单时，表单数据将会提交到login.php页面；然后查找数据库中是否有该用户（数据限制为一行），
     若查找到用户判断用户输入的密码与数据库存储的密码是否相同，若相同则登陆成功，开启session，设置session["islogin"]=1，记录用户的登录状态。  
     导航栏使用内嵌php方式：判断session["islogin"]是否设置值,若已设置值，则利用echo在导航栏中添加含有my account的html元素。否则则利用echo
     添加含用log in的html元素。
   * 注册页面  
     注册页面利用form的action属性提交数据到joinUs.php中进行处理，包括用户名重复检测，用户名，邮箱及密码的有效性，以及弱密码检测等。检测均通过后在数据库中
     插入相应数据。  
     相关正则表达式：  
     合法用户名：/^[A-Za-z0-9_]{6,20}$/u 可包含大小写字母，下划线及数字且限制在6-20位  
     合法邮箱：/^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/u 传统邮箱：只允许英文字母，数字，下划线，英文句号及中划线组成。  
     合法密码：/^[A-Za-z0-9_]{8,16}$/u    可包含大小写字母，下划线及数字且限制在8-16位。  
     弱密码检测:"/^.*[0-9]+.*$/u"&nbsp;&nbsp;  "/^.*[A-z]+.*$/u" 密码需包含数字及字母。  
   * 主页：  
     图片展示区域：数据库travelfavorImage中给出的数据较少,为保证热门图片达到六张，人为添加部分数据。  
     通过ajax实现js与php的数据交互，并利用js的dom方式在页面展示所获得的数据对应的图片。  
     热门图片选取favor最多的六张图片，而图片刷新则随机从数据库中选取图片。  
     导航栏实现方式同上  
   * 浏览页：  
     通过ajax实现js与php的数据交互进行搜索查询。并利用js的dom方式在页面展示所获得的数据对应的图片。  
     对热门的定义：favor图片对应的数量最多的标签。选取两个热门城市标签与两个热门国家标签。由于数据库中
     缺少content字段，人为添加后，选取最热门的标签（限制为一）。  
   * 搜索页面：
     逻辑与浏览页逻辑大致相同。分页逻辑与浏览页有所不同。  
     浏览页分页逻辑：查询数据库获得相应数据后以json数组形式传递给js后，通过json数组获取页面总数（向上取整）。由于浏览页预先设置每个页面16个图片且含16个td的表格已经
     给出，故只需在js中将对应图片放入表格的td中。  
     搜索页面：根据json数组判断页面总数，利用js的dom方式创建相应用于展示图片的html元素。使用bootstap框架实现分页逻辑。  
   * 上传页面与修改页面： 
     修改页面中用户修改的数据会覆盖原有数据行。  
     上传页面利用form的action属性提交数据到php脚本，php脚本向数据库中添加数据行。上传图片的uid会添加到最初始uid的前面。  
   * 我的照片与我的收藏  
     使用bootstrap框架  
     实现pj2需求文档对页面功能的要求。   
     布局方式有所改变，添加一张图片置于导航栏与收藏或上传的图片之间便于美观。  
   * 详细图片  
     利用获取用户session的登录状态，若未登录，则收藏按钮不可用。  
     利用url传递用户所点击图片的path，并据此查询数据库，判断用户是否已经收藏该图片，并显示收藏状态。  
      
 * Bonus完成情况：  
    Hash加盐：  
      注册页面将用户填写的注册密码利用password_hash创建密码的散上传至数据库，用户登陆时利用password_verify进行hash字符串比对，  
      来进行登录逻辑的实现。  
      由于数据库中已经存在的密码是以明文方式存在，故在判断时使用password_verify或密码直接比对（==）的方式判断登录。  
 * 遇到的问题及解决办法：  
    * 主要是ajax的json数组格式问题，刚开始做pj2的过程中，浏览器经常报错json error：invalid character ，然后经常debug几个小时。  
    *  解决办法：在网上查阅后发现，json数组具有严格的格式，注释等会对json数组产生影响，进而产生json数组格式错误。  
       据此修改php脚本后，解决问题。  
 * 对本课程和pj的建议：  
      希望平时的lab能有反馈。   
       
     
       
   
     

    
     
       